const _disableTrackKey="_disableTracker",opts={cursor:null,seperator:".",comma:",",equal:"=",arrayMap:"*",pipe:"|",invoke:"&"},fmtr={},cursor=function(t={},o=opts){return{...o,cursor:t}},withOptions=function(t,o){const e=Object.assign({},t);return o&&Object.assign(e,{[_disableTrackKey]:!0}),e},dig=function(t,o,e=opts,i=fmtr){if(!t||!o)return null;if("object"==typeof o){if(Array.isArray(o))return o.map(o=>dig(t,o,e,i));const s=Object.keys(o),r={};for(const n of s)r[n]=dig(t,o[n],e,i);return r}let s=t,r=o.split(e.seperator);if(e.cursor){const t=[...r],o=t.pop(),s=e.cursor[t.join(e.seperator)];if(s){const r=withOptions(e,!0),n=dig(s,o,r,i);return e.cursor[[...t,o].join(e.seperator)]=n,n}}let n=[];for(let o=0;o<r.length;o+=1){const c=r[o];if(n.push(c),-1!==c.indexOf(e.pipe)){let t=null;const o=c.split(e.pipe),r=withOptions(e,!0);for(const e of o)if(t=dig(s,e,r,i))break;s=t}else if(-1!==c.indexOf(e.comma)){const t=c.split(e.comma),o={},r=withOptions(e,!0);for(const e of t)o[e]=dig(s,e,r,i);s=o}else if(-1!==c.indexOf(e.equal)){const t=c.split(e.equal),o=t[0],i=t[1];s=s.find(t=>o?t[o]==i:t==i)}else if(c===e.arrayMap){o+=1;const t=withOptions(e,!0),c=r.slice(o)[0];e.cursor&&(e.cursor[n.join(e.seperator)]=s,n.push(c)),s=s.map(o=>dig(o,c,t,i))}else if(-1!==c.indexOf(e.invoke)){const o=c.split(e.invoke),r=withOptions(e,!0);let n=dig(s,o.shift(),r,i);for(const e of o)"function"==typeof i[e]&&(n=i[e](n,t));s=n}else s=s[c];if(null==s||null==s)return null;e.cursor&&!e._disableTracker&&(e.cursor[n.join(e.seperator)]=s)}return s},output={dig:dig,cursor:cursor,_withOptions:withOptions,_disableTrackKey:_disableTrackKey,setFormatter:function(t){Object.assign(fmtr,t)},setOptions:function(t){Object.assign(opts,t)}};"undefined"!=typeof window&&Object.assign(window,output),"undefined"!=typeof process&&(module.exports=output);